ğŸ’° Starting Payment Integration Tests...

âœ… DB Connected

ğŸ”¹ Setup: Authenticating...
   Registering new user: payment_test_1771026052521@example.com
   User manually verified in DB
   âœ… Authenticated

Test 1: Create Checkout Session
   Selected Product: Pixel 7 Pro  (Stock set to 100)
   âœ… Session Created: mock_session_1771026052716
   âœ… Order Record Found: HL-20260214-0012
   âœ… Amount Stored: 25.979999999999997 (Expected ~25.98 with shipping)

Test 2: Webhook - Payment Success
   âœ… Webhook Sent
   âœ… Order Updated: Paid & Processing
   â„¹ï¸  Order Payment ID in DB: pi_test_1771026052505
   â„¹ï¸  Expected Payment Intent: pi_test_1771026052505

Test 3: Transaction Verification
   âœ… Transaction Found
   âœ… Amount: 25.98 (Should be decimal)
   âœ… Payment Method: card
   âœ… Amount Conversion Correct

Test 4: Webhook - Payment Failed
   âœ… Order Cancelled on Payment Failure

Test 5: Webhook - Refund

âŒ Payment Tests Failed: Order not refunded: processing
